The source code of bit selection algorithm. Both LiuHuan's and HuangJinjian's can work.